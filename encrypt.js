/*!
* Copyright 584069777@qq.com 2019.
*/
define(["babel-runtime/helpers/classCallCheck","babel-runtime/helpers/createClass","babel-runtime/core-js/symbol","lodash/isString","crypto-js","luck7-webtools/libs/jsencrypt"],function(n,e,t,i,s,a){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n,e=e&&e.hasOwnProperty("default")?e.default:e,t=t&&t.hasOwnProperty("default")?t.default:t,i=i&&i.hasOwnProperty("default")?i.default:i,s=s&&s.hasOwnProperty("default")?s.default:s,a=a&&a.hasOwnProperty("default")?a.default:a;var u=t("rObj"),o=t("sign"),c=function(){function r(e,t){n(this,r),this[u]=new a,e&&this.setKey(e),t&&this.setSignType(t)}return e(r,[{key:"setKey",value:function(e){if(e.public){if(!i(e.public))throw new Error("公钥类型错误");this[u].setPublicKey(e.public)}if(e.private){if(!i(e.private))throw new Error("私钥类型错误");this[u].setPrivateKey(e.private)}}},{key:"setSignType",value:function(e){if(!i(e))throw new Error("签名类型错误");var t=e.toLowerCase();if(!["md5","sha1"].includes(t))throw new Error("错误的签名类型"+e);this[o]=t}},{key:"encrypt",value:function(e){return this[u].encrypt(e)}},{key:"decrypt",value:function(e){return this[u].decrypt(e)}},{key:"sign",value:function(e){if(this[o])return this[u].sign(e,s[this[o].toUpperCase()],this[o])}},{key:"verify",value:function(e,t){if(this[o])return this[u].verify(e,t,s[this[o].toUpperCase()])}}]),r}(),f=t("type"),r=t("key"),h=t("obj"),l=t("enc"),p=t("opts"),d=["utf8","latin1","hex","utf16","base64","utf16le"],y=["cbc","cfb","ctr","ctr-gladman","ofb","ecb"],w=["pkcs7","ansix923","iso10126","iso97971","zeropadding","nopadding"];function v(e){return e.slice(0,1).toUpperCase()+e.slice(1)}var b=function(){function i(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};switch(n(this,i),this[f]=e){case"3DES":this[h]=s.TripleDES;break;case"AES":case"DES":case"MD5":case"SHA1":this[h]=s[e];break;default:throw new Error("不支持的算法类型:"+this[f])}this[l]=s.enc[function(e){if(!e)return v(d[0]);if(d.includes(e.toLowerCase()))return"utf16le"===e?"utf16LE":v(e);throw new Error("未知的编码方式"+e)}(r.enc)],this.setConfig(r),t&&this.setKey(t)}return e(i,[{key:"setConfig",value:function(e){var t={};e.mode&&(t.mode=s.mode[function(e){if(!e)return y[0].toUpperCase();if(y.includes(e.toLowerCase()))return"ctr-gladman"===e?"CTRGladman":e.toUpperCase();throw new Error("未知的加密模式"+e)}(e.mode)]),e.padding&&(t.padding=s.pad[function(e){if(!e)return v(w[0]);if(w.includes(e.toLowerCase()))return v(e).replace("pa","Pa");throw new Error("未知的填充方式"+e)}(e.padding)]),t.iv=this[l].parse(e.iv||"0000000000000000"),this[p]=t}},{key:"setKey",value:function(e){switch(this[f]){case"AES":case"DES":case"3DES":this[r]=this[l].parse(e)}}},{key:"digest",value:function(e){return this[h](e).toString()}},{key:"encrypt",value:function(e){return this[h].encrypt(this[l].parse(e),this[r],this[p]).toString()}},{key:"decrypt",value:function(e){return this[h].decrypt(e,this[r],this[p]).toString(this[l])}}]),i}();return function(e,t){var r=e.toUpperCase(),i="RSA"===r?new c:new b(r,t);return["MD5","SHA1"].includes(r)?function(e){return i.digest(e)}:i}});
